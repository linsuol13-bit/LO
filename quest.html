<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quest Detail • 로나월드</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">
<div class="mx-auto max-w-5xl p-4 sm:p-6 lg:p-8">
  <a href="index.html?tab=quests" class="inline-flex items-center gap-1 text-sm mb-4 text-blue-600 hover:underline">← 퀘스트 목록으로</a>
  <article id="detail"></article>
</div>

<script>
'use strict';

/* ============== Utils ============== */
function imgBox(src, alt, size){ 
  const px = (size === 12) ? 48 : 64;
  if (src) {
    return `<img src="${src}" alt="${alt||''}" loading="lazy" class="rounded-lg" style="display:block">`;
  }
  return `<div class="rounded-lg border bg-white flex items-center justify-center overflow-hidden"
              style="width:${px}px;height:${px}px">
            <span class="text-xs text-gray-400">No Img</span>
          </div>`;
}

/* ============== Images ============== */
const IMG = {
  nella: "https://drive.google.com/thumbnail?id=1oMpXQbJaijD-npUVu2JR7d-cF5_TgsjB&sz=w512",
  greenCap: "https://drive.google.com/thumbnail?id=1e09hggjXTuuCOxBWE2jILeGe7rpaft5a&sz=w512",
  lemon: "https://drive.google.com/thumbnail?id=1aIxoyI3w1lQkx4aGjX0OePhJmz0BNngw&sz=w512",
  bubbleDrop: "https://drive.google.com/thumbnail?id=1ZtmZq-lnEPVRCr1BSUV8eKlCkFgPHm95&sz=w512",
  kerning: "https://placehold.co/120x120?text=Kerning"
};

/* ============== Data ============== */
const quests = [{
  id: 'q-nella-1-1',
  code: '넬라 1-1',
  title: '마파의 의뢰',
  type: '아이템 수집',
  region: '빅토리아 아일랜드',
  minLevel: 15,
  start: { npc:{ name:'넬라', img:IMG.nella }, place:{ name:'커닝시티', img:IMG.kerning } },
  finish:{ npc:{ name:'넬라', img:IMG.nella }, place:{ name:'커닝시티', img:IMG.kerning } },
  reqItems:[
    { name:'초록버섯의 갓', qty:50, img:IMG.greenCap },
    { name:'버블링의 큰 방울', qty:50, img:IMG.bubbleDrop }
  ],
  rewards:[
    { name:'레몬', qty:50, img:IMG.lemon },
    { exp:5600 }
  ],
  dialogues:[
    { who:'넬라', text:'어머? 못보던 사람인걸? 내가 모르는걸 보니 이 마을 사람은 아닌 모양이지?' },
    { who:'넬라', text:'1000메소만 준다면 이 마을사람들의 여러 가지 정보를 모아서 너와 연결시켜 줄게.' },
    { who:'넬라', text:'좋아! 1000 메소도 받았겠다. 약속은 지켜야 겠지? 우선 당장 급한 의뢰가 들어와 있으니 서둘러 주길 바래.' },
    { who:'넬라', text:'<span class="font-bold text-blue-600">초록버섯의 갓 50개</span>와 <span class="font-bold text-blue-600">버블링의 큰 방울 50개</span>가 필요하다는데 너라면 이런것 모으는 것 쯤은 아무것도 아니겠지?' }
  ],
  completionDialogue:{ who:'넬라', text:'엇... 생각보다 빨리 돌아왔는걸? 역시 내가 사람보는 눈은 있다니까!' },
  description: `커닝시티의 넬라에게 1,000 메소를 주고 이 마을 주민들이 도움을 필요로 할 때마다 소개시켜줄 것을 약속했다. 우선은 방어구 상점 주인은 마파가 새로운 방어구를 만들기 위한 재료로 초록버섯의 갓 50개와 버블링의 큰 방울 50개를 모아와 달라고 했다는데...

초록버섯은 공사장이나 풀숲에서, 버블링은 지하철에서 흔히볼 수 있으니 그다지 어려울 것 같진 않은걸?`
}];

/* ============== Helpers ============== */
function duoRow(labelLeft, imgLeft, nameLeft, labelRight, imgRight, nameRight){
  return `<div class="flex items-center gap-4">
    <div class="flex items-center gap-3">
      ${imgBox(imgLeft, nameLeft, 16)}
      <div class="text-sm"><div class="text-gray-500">${labelLeft}</div><div class="font-medium">${nameLeft||'-'}</div></div>
    </div>
    <div class="text-gray-300">|</div>
    <div class="flex items-center gap-3">
      ${imgBox(imgRight, nameRight, 16)}
      <div class="text-sm"><div class="text-gray-500">${labelRight}</div><div class="font-medium">${nameRight||'-'}</div></div>
    </div>
  </div>`;
}
function reqItemView(r){
  const left = imgBox(r.img, r.name, 16);
  return `<div class="flex items-center gap-3">${left}<div class="text-sm font-medium">${r.name} ×${r.qty}</div></div>`;
}
function rewardView(r){
  if (typeof r.exp === 'number'){
    return `<div class="flex items-center gap-3">
      ${imgBox('', 'EXP', 16)}
      <div class="text-sm font-medium">경험치 ${r.exp.toLocaleString()} exp</div>
    </div>`;
  }
  const left = imgBox(r.img, r.name, 16);
  return `<div class="flex items-center gap-3">${left}<div class="text-sm font-medium">${r.name} ×${r.qty}</div></div>`;
}
function dialogueView(d){
  return `<div class="flex items-start gap-4">
    ${imgBox(IMG.nella, d.who, 16)}
    <div class="text-sm leading-snug mt-0.5"><b>${d.who||''}:</b> ${d.text||''}</div>
  </div>`;
}

/* ============== Render ============== */
(function(){
  const $detail = document.getElementById('detail');
  const id = new URLSearchParams(location.search).get('id') || 'q-nella-1-1';
  let q = quests.find(x=> x.id===id);
  if (!q) {
    $detail.innerHTML = '<div class="p-6 text-center text-sm text-gray-500 bg-white rounded-xl border">퀘스트를 찾을 수 없습니다.</div>';
    return;
  }
  $detail.innerHTML = `
    <header class="mb-4">
      <h1 class="text-2xl font-bold">${q.code} · ${q.title}</h1>
      <p class="text-sm text-gray-600">${q.region} · ${q.type} · Lv.${q.minLevel}</p>
    </header>

    <section class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div class="rounded-xl border bg-white p-4">
        <h2 class="text-sm font-semibold mb-3">시작</h2>
        ${duoRow('시작 NPC', q.start?.npc?.img, q.start?.npc?.name, '시작 장소', q.start?.place?.img, q.start?.place?.name)}
      </div>
      <div class="rounded-xl border bg-white p-4">
        <h2 class="text-sm font-semibold mb-3">완료</h2>
        ${duoRow('완료 NPC', q.finish?.npc?.img, q.finish?.npc?.name, '완료 장소', q.finish?.place?.img, q.finish?.place?.name)}
      </div>
    </section>

    <section class="mb-6">
      <h2 class="text-sm font-semibold mb-2">퀘스트 조건</h2>
      <div class="rounded-xl border bg-white p-4 space-y-4">
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
          ${(q.reqItems||[]).map(reqItemView).join('') || '<div class="text-sm text-gray-500">조건 없음</div>'}
        </div>
        <div class="text-sm leading-relaxed whitespace-pre-line text-gray-700">
          ${q.description || ''}
        </div>
      </div>
    </section>

    <section class="mb-4">
      <h2 class="text-sm font-semibold mb-2">완료 보상</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
        ${(q.rewards||[]).map(rewardView).join('')}
      </div>
    </section>

    <section class="mb-10">
      <h2 class="text-sm font-semibold mb-2">완료 대사</h2>
      <div class="rounded-xl border bg-white p-4">
        ${dialogueView(q.completionDialogue||{})}
      </div>
    </section>
  `;
})();
</script>
</body>
</html>
