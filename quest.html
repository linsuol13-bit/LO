<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>퀘스트 상세 • 로나월드</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif; }
    .card { border:1px solid #e5e7eb; border-radius:0.75rem; background:#fff; padding:1rem; }
    .muted { color:#6b7280; }
    .row { display:flex; align-items:center; gap:.75rem; }
    .grid { display:grid; gap:1rem; }
    /* 일반 이미지: 기본 스타일 없음 (원본 그대로) */
    img { max-width:100%; height:auto; }
    /* 조건/보상 전용 썸네일 */
    .thumb { width:56px; height:56px; object-fit:contain; background:#fff; border:1px solid #e5e7eb; border-radius:0.5rem; padding:4px; }
    /* 한 줄 박스 */
    .ibox { display:flex; align-items:center; gap:.75rem; padding:.5rem; border:1px solid #e5e7eb; border-radius:0.75rem; background:#fff; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
<div class="mx-auto max-w-5xl p-4 sm:p-6 lg:p-8">
  <a href="index.html?tab=quests" class="inline-flex items-center gap-1 text-sm mb-4 text-blue-600 hover:underline">← 퀘스트 목록으로</a>
  <article id="detail"></article>
</div>

<script>
(() => {
  'use strict';

  const IMG = {
    nella: "https://drive.google.com/thumbnail?id=1oMpXQbJaijD-npUVu2JR7d-cF5_TgsjB&sz=w512",
    greenCap: "https://drive.google.com/thumbnail?id=1e09hggjXTuuCOxBWE2jILeGe7rpaft5a&sz=w512",
    lemon: "https://drive.google.com/thumbnail?id=1aIxoyI3w1lQkx4aGjX0OePhJmz0BNngw&sz=w512",
    bubbleDrop: "https://drive.google.com/thumbnail?id=1ZtmZq-lnEPVRCr1BSUV8eKlCkFgPHm95&sz=w512",
    kerning: "https://placehold.co/120x120?text=Kerning",
    exp: "https://placehold.co/56x56?text=EXP"
  };

  const QUEST = {
    id: '2029',
    code: '넬라 1-1',
    title: '마파의 의뢰',
    type: '아이템 수집',
    region: '빅토리아 아일랜드',
    minLevel: 15,
    start: { npc:{ name:'넬라', img:IMG.nella }, place:{ name:'커닝시티', img:IMG.kerning } },
    finish:{ npc:{ name:'넬라', img:IMG.nella }, place:{ name:'커닝시티', img:IMG.kerning } },
    reqItems:[
      { name:'초록버섯의 갓', qty:50, img:IMG.greenCap, itemId:'4000012' },
      { name:'버블링의 큰 방울', qty:50, img:IMG.bubbleDrop }
    ],
    rewards:[
      { name:'레몬', qty:50, img:IMG.lemon, itemId:'2010004' },
      { exp:5600, img:IMG.exp }
    ],
    dialogues:[
      { who:'넬라', text:'어머? 못보던 사람인걸? 내가 모르는걸 보니 이 마을 사람은 아닌 모양이지? 난 이마을의 정보통으로 통하는 넬라야. 이 마을에서 일어나는 여러가지 소식들을 빠짐없이 모두 알고 있지.' },
      { who:'넬라', text:'1000메소만 준다면 이 마을사람들의 여러 가지 정보를 모아서 너와 연결시켜 줄게. 그러니까 마을사람 중 누군가가 도움이 필요한 일이 있으면 너에게 소개시켜 준다는 말씀! 어때? 해볼래?' },
      { who:'넬라', text:'좋아! 1000 메소도 받았겠다. 약속은 지켜야 겠지? 우선 당장 급한 의뢰가 들어와 있으니 서둘러 주길 바래. 이 마을에서 방어구점을 운영하고 있는 마파 씨가 최근 새로운 방어구를 만들기 위해 독특한 재료를 모으고 있는 모양이야.' },
      { who:'넬라', text:'<span class="font-bold text-blue-600">초록버섯의 갓 50개</span>와 <span class="font-bold text-blue-600">버블링의 큰 방울 50개</span>가 필요하다는데 너라면 이런것 모으는 것 쯤은 아무것도 아니겠지? 물론 사례는 섭섭하지 않을 정도로 해 준다고 약속했으니 걱정말라고. 그럼 모으는 대로 다시 나에게 돌아와 줘. 기다리고 있을게!' }
    ],
    completionDialogue:{ who:'넬라', text:'엇... 생각보다 빨리 돌아왔는걸? 역시 내가 사람보는 눈은 있다니까! 좋아! 이렇게 의뢰를 무사히 해결해 줬으니 사례를 해야겠지. 마파씨가 여행에 도움이 되라는 뜻에서 레몬을 잔뜩 맡기셨으니 받으라고~' }
  };

  const descHtml = `<p>커닝시티의 넬라에게 1,000 메소를 주고 이 마을 주민들이 도움을 필요로 할 때마다 소개시켜줄 것을 약속했다. 우선은 방어구 상점 주인은 마파가 새로운 방어구를 만들기 위한 재료로 초록버섯의 갓 50개와 버블링의 큰 방울 50개를 모아와 달라고 했다는데...</p><p class="mt-3">초록버섯은 공사장이나 풀숲에서, 버블링은 지하철에서 흔히볼 수 있으니 그다지 어려울 것 같진 않은걸?</p>`;

  const $detail = document.getElementById('detail');

  const img = (src, alt, cls='') => `<img src="${src||''}" alt="${alt||''}" ${cls?`class="${cls}"`:''} onerror="this.style.display='none'">`;

  const row = (labelLeft, imgLeft, nameLeft, labelRight, imgRight, nameRight) => `
    <div class="row">
      <div class="row">
        ${img(imgLeft, nameLeft)}
        <div class="text-sm">
          <div class="muted">${labelLeft}</div>
          <div class="font-medium">${nameLeft||'-'}</div>
        </div>
      </div>
      <div class="muted" style="padding:0 .5rem">|</div>
      <div class="row">
        ${img(imgRight, nameRight)}
        <div class="text-sm">
          <div class="muted">${labelRight}</div>
          <div class="font-medium">${nameRight||'-'}</div>
        </div>
      </div>
    </div>
  `;

  const reqItemBox = r => {
    const title = `${r.name||''} ×${r.qty||0}`;
    const pic = img(r.img, r.name, 'thumb');
    const inner = `<div class="text-sm font-medium">${title}</div>`;
    return r.itemId
      ? `<a class="ibox" href="item.html?id=${r.itemId}">${pic}${inner}</a>`
      : `<div class="ibox">${pic}${inner}</div>`;
  };

  const rewardBox = r => {
    if (typeof r.exp === 'number') {
      const pic = img(r.img || IMG.exp, 'EXP', 'thumb');
      const txt = `<div class="text-sm font-medium">경험치 ${r.exp.toLocaleString()} exp</div>`;
      return `<div class="ibox">${pic}${txt}</div>`;
    }
    const title = `${r.name||''} ×${r.qty||0}`;
    const pic = img(r.img, r.name, 'thumb');
    const inner = `<div class="text-sm font-medium">${title}</div>`;
    return r.itemId
      ? `<a class="ibox" href="item.html?id=${r.itemId}">${pic}${inner}</a>`
      : `<div class="ibox">${pic}${inner}</div>`;
  };

  const dialogueRow = d => `
    <div class="row">
      ${img(IMG.nella, d.who)}
      <div class="text-sm leading-snug mt-0.5"><b>${d.who||''}:</b> ${d.text||''}</div>
    </div>
  `;

  // Render
  const q = QUEST; // (id는 2029로 고정)
  $detail.innerHTML = `
    <header class="mb-4">
      <h1 class="text-2xl font-bold">${q.code} · ${q.title}</h1>
      <p class="text-sm muted">${q.region} · ${q.type} · Lv.${q.minLevel}</p>
    </header>

    <section class="grid" style="grid-template-columns:1fr 1fr;">
      <div class="card">
        <h2 class="text-sm font-semibold mb-3">시작</h2>
        ${row('시작 NPC', q.start.npc.img, q.start.npc.name, '시작 장소', q.start.place.img, q.start.place.name)}
      </div>
      <div class="card">
        <h2 class="text-sm font-semibold mb-3">완료</h2>
        ${row('완료 NPC', q.finish.npc.img, q.finish.npc.name, '완료 장소', q.finish.place.img, q.finish.place.name)}
      </div>
    </section>

    <section class="mb-6">
      <h2 class="text-sm font-semibold mb-2">대사</h2>
      <div class="card" style="display:grid; gap:.5rem">
        ${q.dialogues.map(dialogueRow).join('')}
      </div>
    </section>

    <section class="mb-6">
      <h2 class="text-sm font-semibold mb-2">퀘스트 조건</h2>
      <div class="card text-sm leading-relaxed text-gray-800 mb-3">${descHtml}</div>
      <div class="grid">
        ${q.reqItems.map(reqItemBox).join('')}
      </div>
    </section>

    <section class="mb-10">
      <h2 class="text-sm font-semibold mb-2">완료 보상</h2>
      <div class="grid">
        ${q.rewards.map(rewardBox).join('')}
      </div>
    </section>
  `;
})();
</script>
</body>
</html>
