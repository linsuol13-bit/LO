<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title></title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif; }
  .card { border:1px solid #e5e7eb; border-radius:0.75rem; background:#fff; padding:1rem; }
  .muted { color:#6b7280; }
  .row { display:flex; align-items:center; gap:.75rem; }
  .grid { display:grid; gap:1rem; }
  img { max-width:100%; height:auto; }
  .thumb { width:56px; height:56px; object-fit:contain; background:#fff; border:1px solid #e5e7eb; border-radius:0.5rem; padding:4px; }
  .ibox { display:flex; align-items:center; gap:.75rem; padding:.5rem; border:1px solid #e5e7eb; border-radius:0.75rem; background:#fff; transition: background .15s ease; }
  .ibox:hover { background:#f9fafb; }
  .bubble{position:relative;max-width:80%;padding:.625rem .75rem;border-radius:1rem;line-height:1.55;box-shadow:0 1px 2px rgba(0,0,0,.06); font-size:0.9rem; white-space:pre-line;}
  .bubble-left{background:#f8fafc;border:1px solid #e5e7eb;color:#111827}
  .bubble-right{background:#3b82f6;border:1px solid #1d4ed8;color:#fff}
  .bubble-name{font-weight:600;font-size:.875rem;margin-bottom:.125rem}
  .avatar{width:40px;height:40px;border-radius:9999px;border:1px solid #e5e7eb;object-fit:cover;background:#fff}
  .pill {display:inline-flex;align-items:center;gap:.4rem;padding:.15rem .5rem;border-radius:999px;background:#eef2ff;color:#3730a3;font-size:.75rem;border:1px solid #c7d2fe}
</style>
</head>
<body class="bg-gray-50 text-gray-900">
<div class="mx-auto max-w-5xl p-4 sm:p-6 lg:p-8">
<a class="inline-flex items-center gap-1 text-sm mb-4 text-blue-600 hover:underline" href="index.html?tab=quests" id="back-to-quests">← 퀘스트 목록으로</a>
<article id="detail"></article>
</div>
<script>
(()=>{
  'use strict';
  const q = {
  "id": "2184",
  "code": "블랙바크 1-1",
  "title": "블랙바크의 근심",
  "type": "아이템 수집",
  "region": "노틸러스",
  "minLevel": 30,
  "prereqs": [],
  "start": {
    "npc": {
      "name": "블랙바크",
      "img": "https://drive.google.com/thumbnail?id=1DTjxbj0y3nU7cvdmlAuuFM3kH16Tv4GH&sz=w120",
      "id": "1092006"
    },
    "place": {
      "name": "노틸러스호 회의실",
      "img": "https://drive.google.com/thumbnail?id=1CeDRjBJlSkcQJ48OiA6GmfUKpISk1Lz3&sz=w800",
      "code": "120000201"
    }
  },
  "finish": {
    "npc": {
      "name": "밍밍부인",
      "img": "https://drive.google.com/thumbnail?id=1LZrvx0Ehg8iOMjYyzwmVnn5fXp0P-ywi&sz=w120",
      "id": "2142901"
    },
    "place": {
      "name": "헤네시스",
      "img": "https://drive.google.com/thumbnail?id=1DHyZxIGD_36QG3yjuxhl_veS9AqzwAmh&sz=w800",
      "code": "100000000"
    }
  },
  "dialogues": [
    {
      "who": "블랙바크",
      "text": "하하핫~ 거기 자네 !! 곧 카이린의 생일이란 걸 알고 있나? 어휴~ 꼬마 숙녀일때부터 데리고 다닌 녀석이 벌써 이렇게 커버리다니… 감동이야~ 감동!"
    },
    {
      "who": "블랙바크",
      "text": "그렇지. 그래서 얼마 전에 선원 투표를 했는데 카이린의 생일 선물로 가장 좋은 걸로 드레스가 당첨 되었지. 하핫~ 나도 그 녀석을 오래봐왔지만 여성스러운 드레스를 입은 적을 본 적이 없어. 그래서 드레스 제작을 내 오랜 친구 밍밍부인에게 부탁했네. 그런데… 재료가 없다고! 혹시 자네가 구해다 줄 수 있겠나?"
    },
    {
      "who": "블랙바크",
      "text": "하하하~ 요새 젊은이들 답지 않게 성실하고 착하고 대단히 멋진 선원이군! 역시 노틸러스호 선원이야! 드레스 제작을 위해선 하얗고 얇고 질 좋은 천이 필요한데 그게 주니어 레이스의 식탁보가 제격이라고 하더군. 식탁보 40개만 모아서 밍밍부인에게 가져다 주게."
    }
  ],
  "completionDialogues": [
    {
      "who": "밍밍부인",
      "text": "블랙바크에게 미리 들었어요. 무턱대고 부탁하는 것은 예나 지금이나 똑같아. 어휴~ 난 축제 준비 때문에 바쁜데~ 오랜 친구만 아니면 거절했을텐데…"
    },
    {
      "who": "밍밍부인",
      "text": "식탁보 40개 맞네요. 자아~ 이제 드레스를 제작해볼까나?"
    }
  ],
  "descHtml": "<p>블랙바크는 카이린의 생일 선물로 모두의 염원을 담은 예쁜 드레스를 선물해주고 싶다고 했다. 헤네시스에 살고 있는 오랜 친구 밍밍부인에게 드레스 제작을 의뢰했는데 새하얀 천이 부족하다고 했다. 드레스를 만드는데는 주니어 레이스의 식탁보가 최고라고 하는데… 식탁보 40개를 모아 밍밍부인에게 가보자.</p>",
  "reqs": [
    {
      "type": "item",
      "name": "식탁보",
      "img": "https://drive.google.com/thumbnail?id=1NrBHVxUmf3cXn53gMFHAH-SH9IXRvPfQ&sz=w120",
      "qty": 40,
      "id": "4000035"
    }
  ],
  "startCond": null,
  "tip": {
    "text": null,
    "monster": {
      "name": "주니어 레이스",
      "level": 35,
      "img": "https://drive.google.com/thumbnail?id=1w5j7l3OPRvlfEIB4-1VbdOpSW5Inc8cz&sz=w120",
      "id": "3230101"
    }
  },
  "make": null,
  "rewards": [
    {
      "exp": 84000,
      "img": "https://drive.google.com/thumbnail?id=1O9FuxyZEG_nZVJikWShUPKvb5zCH7t-z&sz=w200"
    }
  ],
  "rewardItems": null,
  "rewardMeso": null,
  "rewardMesoImg": null,
  "rewardPop": null,
  "rewardPopImg": null,
  "nexts": [
    {
      "id": "2185",
      "title": "카이린을 위한 드레스"
    }
  ]
};
document.title = `${q.code} · ${q.title}`;

  const img=(src,alt='',cls='')=>`<img src="${src||''}" alt="${alt||''}" ${cls?`class="${cls}"`:''} onerror="if(!this.dataset.fbk){this.dataset.fbk=1;this.src=this.src.replace('thumbnail?id=','uc?export=view&id=');}else{this.style.display='none'}">`;
  const row=(l,il,nl,r,ir,nr,ll='',lr='')=>{
    const cell=(label,im,name,link)=>{
      const inner=`${im?img(im,name):''}<div class='text-sm'><div class='muted'>${label}</div><div class='font-medium'>${name||'-'}</div></div>`;
      return link?`<a class='row' href='${link}'>${inner}</a>`:`<div class='row'>${inner}</div>`;
    };
    return `<div class='row'>${cell(l,il,nl,ll)}<div class='muted' style='padding:0 .5rem'>|</div>${cell(r,ir,nr,lr)}</div>`;
  };
  const boxLink=(href,inner)=> href?`<a class='ibox' href='${href}'>${inner}</a>`:`<div class='ibox'>${inner}</div>`;
  const rewardBox = r => {
    if (typeof r.exp === 'number') {
      const pic = img(r.img, 'EXP', 'thumb');
      const txt = `<div class='text-sm font-medium'>경험치 ${r.exp.toLocaleString()} exp</div>`;
      return `<div class='ibox'>${pic}${txt}</div>`;
    }
    return '';
  };
  const reqBox = r => {
    const qty = (r.qty && r.qty>0) ? ' ×'+r.qty : '';
    const title = `${r.name||''}${qty}`;
    const pic = img(r.img, r.name, 'thumb');
    const href = r.id ? `https://linsuol13-bit.github.io/LO/item-${r.id}.html` : '';
    const inner = `${pic}<div class='text-sm'><div class='muted'>필요 아이템</div><div class='font-medium'>${title}</div></div>`;
    return boxLink(href, inner);
  };
  const tipBox = m => {
    if (!m) return '';
    const href = m.id ? `https://linsuol13-bit.github.io/LO/monster-${m.id}.html` : '';
    const inner = `${img(m.img || '', m.name || '', 'thumb')}<div class='text-sm'><div class='font-medium'>${m.name || ''} · Lv.${m.level || ''}</div></div>`;
    return boxLink(href, inner);
};
  const prereqSection=list=>{
    if(!Array.isArray(list)||!list.length)return'';
    const boxes=list.map(p=>`<a class='ibox' href='https://linsuol13-bit.github.io/LO/quest-${p.id}.html'><div class='text-sm'><div class='muted'>선행 퀘스트</div><div class='font-medium'>${p.title}</div></div></a>`).join('');
    return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>선행 퀘스트</h2><div class='grid'>${boxes}</div></section>`;
  };
  const nextSection=list=>{
    if(!Array.isArray(list)||!list.length)return'';
    const boxes=list.map(n=>`<a class='ibox' href='https://linsuol13-bit.github.io/LO/quest-${n.id}.html'><div class='text-sm'><span class='pill'>다음</span><div class='font-medium'>${n.title}</div></div></a>`).join('');
    return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>다음 퀘스트</h2><div class='grid'>${boxes}</div></section>`;
  };
  const isPlayer=w=>/^(나|플레이어|주인공|Player|영웅)$/i.test((w||'').toString().trim());
  const avatarFor=who=>{ if(who===(q.start.npc&&q.start.npc.name))return q.start.npc.img; if(who===(q.finish.npc&&q.finish.npc.name))return q.finish.npc.img; return ''; };
  const dialogueRow=d=>{ d=d||{}; const left=!isPlayer(d.who); const av=left?avatarFor(d.who):''; const avatar=(left&&av)?`<img class='avatar' src='${av}' alt='${d.who||''}' onerror="if(!this.dataset.fbk){this.dataset.fbk=1;this.src=this.src.replace('thumbnail?id=','uc?export=view&id=');}else{this.style.display='none'}">`:''; return `<div class='flex items-start ${left?'justify-start':'justify-end'} gap-2'>${left?avatar:''}<div class='bubble ${left?'bubble-left':'bubble-right'}'><div class='bubble-name'>${d.who||''}</div><div>${d.text||''}</div></div></div>`; };

  const hasReqs = Array.isArray(q.reqs) && q.reqs.length>0;
  const hasTipText = q.tip && q.tip.text;
  const hasTipMonster = q.tip && q.tip.monster;
  let conditionsHtml = '';
  if ((q.descHtml && q.descHtml.length>0) || hasReqs) {
    const reqBoxes = hasReqs ? q.reqs.map(r=>{
      const qty = (r.qty && r.qty>0) ? ' ×'+r.qty : '';
      const title = `${r.name||''}${qty}`;
      const pic = img(r.img, r.name, 'thumb');
      const href = r.id ? `item-${r.id}.html` : '';
      const inner = `${pic}<div class='text-sm'><div class='muted'>${r.type==='몬스터'?'처치 대상':'요구 아이템'}</div><div class='font-medium'>${title}</div></div>`;
      return boxLink(href, inner);
    }).join('') : '';
    conditionsHtml = `
    <section class='mb-6'>
      <h2 class='text-sm font-semibold mb-2'>퀘스트 조건</h2>
      ${q.descHtml ? `<div class='card text-sm leading-relaxed text-gray-800 mb-3'>${q.descHtml}</div>` : ''}
      ${hasReqs ? `<div class='mt-3'><div class='muted text-xs mb-1'>요구 조건</div><div class='grid' style='grid-template-columns:1fr; gap:.75rem'>${reqBoxes}</div></div>` : ''}
    </section>`;
  }
  const tipTextHtml = t => `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>TIP</h2><div class='ibox'><div class='text-sm'>${t}</div></div></section>`;
  const tipMonsterHtml = m => {
    const href = m.id ? `monster-${m.id}.html` : '';
    const inner = `${img(m.img || '', m.name || '', 'thumb')}<div class='text-sm'><div class='font-medium'>${m.name || ''} · Lv.${m.level || ''}</div></div>`;
    return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>TIP</h2>${boxLink(href, inner)}</section>`;
  };
  const tipHtml = hasTipText ? tipTextHtml(q.tip.text) : (hasTipMonster ? tipMonsterHtml(q.tip.monster) : '');

  const $detail=document.getElementById('detail');
  $detail.innerHTML=`
    <header class='mb-4'><h1 class='text-2xl font-bold'>${q.code} · ${q.title}</h1><p class='text-sm muted'>${q.region} · ${q.type} · Lv.${q.minLevel}</p></header>
    ${prereqSection(q.prereqs)}
    <section class='grid' style='grid-template-columns:1fr 1fr;'>
      <div class='card'><h2 class='text-sm font-semibold mb-3'>시작</h2>${row('시작 NPC', q.start.npc.img, q.start.npc.name, '시작 장소', q.start.place.img, q.start.place.name, (q.start.npc.id?`https://linsuol13-bit.github.io/LO/npc-${q.start.npc.id}.html`:''), (q.start.place.code?`https://linsuol13-bit.github.io/LO/map-${q.start.place.code}.html`:''))}</div>
      <div class='card'><h2 class='text-sm font-semibold mb-3'>완료</h2>${row('완료 NPC', q.finish.npc.img, q.finish.npc.name, '완료 장소', q.finish.place.img, q.finish.place.name, (q.finish.npc.id?`https://linsuol13-bit.github.io/LO/npc-${q.finish.npc.id}.html`:''), (q.finish.place.code?`https://linsuol13-bit.github.io/LO/map-${q.finish.place.code}.html`:''))}</div>
    </section>
    <section class='mb-6'><h2 class='text-sm font-semibold mb-2'>진행 대사</h2><div class='card'>${q.dialogues.map(dialogueRow).join("")}</div></section>
    ${conditionsHtml}
    ${tipHtml}
    <section class='mb-6'><h2 class='text-sm font-semibold mb-2'>완료 대사</h2><div class='card'>${q.completionDialogues.map(dialogueRow).join("")}</div></section>
    <section class='mb-6'><h2 class='text-sm font-semibold mb-2'>완료 보상</h2><div class='grid'>${q.rewards.map(rewardBox).join('')}</div></section>
    ${nextSection(q.nexts)}
  `;
})();
</script>
</body>
</html>
