<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>퀘스트 상세 • 정체불명 그녀의 정체</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif; }
  .card { border:1px solid #e5e7eb; border-radius:0.75rem; background:#fff; padding:1rem; }
  .muted { color:#6b7280; }
  .row { display:flex; align-items:center; gap:.75rem; }
  .grid { display:grid; gap:1rem; }
  img { max-width:100%; height:auto; }
  .thumb { width:56px; height:56px; object-fit:contain; background:#fff; border:1px solid #e5e7eb; border-radius:0.5rem; padding:4px; }
  .ibox { display:flex; align-items:center; gap:.75rem; padding:.5rem; border:1px solid #e5e7eb; border-radius:0.75rem; background:#fff; transition: background .15s ease; }
  .ibox:hover { background:#f9fafb; }
  .bubble{position:relative;max-width:80%;padding:.625rem .75rem;border-radius:1rem;line-height:1.55;box-shadow:0 1px 2px rgba(0,0,0,.06); font-size:0.9rem; white-space:pre-line;}
  .bubble-left{background:#f8fafc;border:1px solid #e5e7eb;color:#111827}
  .bubble-right{background:#3b82f6;border:1px solid #1d4ed8;color:#fff}
  .bubble-name{font-weight:600;font-size:.875rem;margin-bottom:.125rem}
  .avatar{width:40px;height:40px;border-radius:9999px;border:1px solid #e5e7eb;object-fit:cover;background:#fff}
</style>
</head>
<body class="bg-gray-50 text-gray-900">
<div class="mx-auto max-w-5xl p-4 sm:p-6 lg:p-8">
<a class="inline-flex items-center gap-1 text-sm mb-4 text-blue-600 hover:underline" href="index.html?tab=quests" id="back-to-quests">← 퀘스트 목록으로</a>
<article id="detail"></article>
</div>
<script>
(()=>{
  'use strict';
  const q = {"id": "2072", "code": "정체불명의 그녀 1-2", "title": "정체불명 그녀의 정체", "type": "아이템 수집", "region": "커닝시티", "minLevel": 25, "prereq": {"id": "2071", "title": "정체불명 그녀의 부탁"}, "start": {"npc": {"name": "정체불명의 그녀", "img": "https://drive.google.com/thumbnail?id=1XDoGeE8rbJa0KZQ4QvlvJSW4cdI2-1sR&sz=w120", "id": "1052105"}, "place": {"name": "커닝시티 니오라병원", "img": "https://drive.google.com/thumbnail?id=1L4emtFK-gIv73EKFPrXaJUuOMevmpVEC&sz=w800", "code": "103000004"}}, "finish": {"npc": {"name": "정체불명의 그녀", "img": "https://drive.google.com/thumbnail?id=1XDoGeE8rbJa0KZQ4QvlvJSW4cdI2-1sR&sz=w120", "id": "1052105"}, "place": {"name": "커닝시티 니오라병원", "img": "https://drive.google.com/thumbnail?id=1L4emtFK-gIv73EKFPrXaJUuOMevmpVEC&sz=w800", "code": "103000004"}}, "dialogues": [{"who": "정체불명의 그녀", "text": "아 ….. 조금 깨지긴 했지만 얼굴을 비춰볼 수는 있겠어요."}, {"who": "정체불명의 그녀", "text": "도와주셔서 정말 감사합니다 ... 붕대를 풀고 어서 여길 나가야 겠어요. 여긴 너무 추워요."}, {"who": "정체불명의 그녀", "text": "꺅 !! 이럴수가 !!… 이…이게 …. 어떻게 된 일이죠? 왜 제가 거울에 비춰지지 않는거에요 ?…. 그럼 …. 그럼 제가 죽었다는 말인가요? 아냐 !! 그럴 리 없어! 전 아직 죽을 수 없어요 !! 이봐요 당신! 다시 한번 내 부탁을 좀 들어줘요!"}, {"who": "정체불명의 그녀", "text": "좀비버섯이란 몬스터를 죽이면 죽은 자의 부적이라는 것을 주는데,그 부적엔 죽은 존재를 다시 살려내는 기운이 담겨져있다고 해요. 그 부적을 좀 구해다 주세요. 죽은 자의 부적100개만 있다면 저도 되살아날 수 있을 거에요 ..."}], "completionDialogues": [{"who": "정체불명의 그녀", "text": "아! 부적을 모두 구해 오셨군요 ... 감사해요 ... 절 위해서 이렇게까지 노력해주시다니…솔직히 말씀드릴게요 ... 힘들게 구해오셨지만 이 부적으로도 전 다시 되살아날 수가 없어요 ..."}, {"who": "정체불명의 그녀", "text": "부적의 힘으로 다시 되살아난다고 해도 살아있다고 할 수 없는 그런 존재일 뿐 ….. 그것을 이제서야 깨닫게 되다니 ….. 하지만 저를 위해 노력해 주셔서 정말 감사해요. 영원히 잊지 못할 거에요."}, {"who": "정체불명의 그녀", "text": "제가 드린 망토는 잘 받으셨나요? 죽은자의 부적의 힘을 이용해서 만든 거랍니다. 분명 당신에게 도움이 될 거에요. 그럼... 안녕히... 언젠가는 다시 만날 수 있겠죠..."}], "descHtml": "<p>니오라병원에서 만났던 그녀의 정체는 놀랍게도 유령이었다. 자신이 죽은 줄도 모르고 병원에 남아서 니오라씨가 돌아오기만을 기다렸다니 .. 자신이 죽었다는걸 인정하려 하지 않는 그녀는 자신이 되살아나기 위해서는 죽은 자의 부적 100개가 필요하다면서 다시 한번만 더 도와달라고 부탁했다. 정말 그것만 있으면 그녀는 되살아날 수 있는걸까?</p>", "reqs": [{"type": "item", "name": "죽은 자의 부적", "img": "https://drive.google.com/thumbnail?id=1hBXf-QxPwcmk1JX8UvH-NPFkrVYqL_MX&sz=w200", "qty": 100, "id": "4000008"}], "rewardItems": [{"name": "허름한 망토", "img": "https://drive.google.com/thumbnail?id=1MCNb3lQvBWr_oEyTHg6QKw3DXFSdIqXd&sz=w200", "qty": 1, "id": "1102053"}], "rewards": [{"exp": 35000, "img": "https://drive.google.com/thumbnail?id=1O9FuxyZEG_nZVJikWShUPKvb5zCH7t-z&sz=w200"}], "next": {}};

  const img=(src,alt='',cls='')=>`<img src="${src||''}" alt="${alt||''}" ${cls?`class="${cls}"`:''} onerror="if(!this.dataset.fbk){this.dataset.fbk=1;this.src=this.src.replace('thumbnail?id=','uc?export=view&id=');}else{this.style.display='none'}">`;
  const row=(l,il,nl,r,ir,nr,ll='',lr='')=>{
    const cell=(label,im,name,link)=>{
      const inner=`${im?img(im,name):''}<div class='text-sm'><div class='muted'>${label}</div><div class='font-medium'>${name||'-'}</div></div>`;
      return link?`<a class='row' href='${link}'>${inner}</a>`:`<div class='row'>${inner}</div>`;
    };
    return `<div class='row'>${cell(l,il,nl,ll)}<div class='muted' style='padding:0 .5rem'>|</div>${cell(r,ir,nr,lr)}</div>`;
  };
  const boxLink=(href,inner)=> href?`<a class='ibox' href='${href}'>${inner}</a>`:`<div class='ibox'>${inner}</div>`;
  const rewardBox = r => {
  // EXP reward
  if (typeof r.exp === 'number') {
    const pic = img(r.img, 'EXP', 'thumb');
    const txt = `<div class='text-sm font-medium'>경험치 ${r.exp.toLocaleString()} exp</div>`;
    return `<div class='ibox'>${pic}${txt}</div>`;
  }
  // FAME reward
  if (typeof r.fame === 'number') {
    const pic = img(r.img, 'FAME', 'thumb');
    const txt = `<div class='text-sm font-medium'>인기도 +${r.fame.toLocaleString()}</div>`;
    return `<div class='ibox'>${pic}${txt}</div>`;
  }
  // Item reward (with optional quantity)
  const title = `${r.name || ''}${(r.qty && r.qty > 0) ? ' ×' + r.qty : ''}`;
  const pic = img(r.img, r.name, 'thumb');
  const inner = `<div class='text-sm font-medium'>${title}</div>`;
  return r.itemId
    ? boxLink(`https://linsuol13-bit.github.io/LO/item-${r.itemId}.html`, `${pic}${inner}`)
    : `<div class='ibox'>${pic}${inner}</div>`;
};
  const reqBox = r => {
  const qty = (r.qty && r.qty>0) ? ' ×'+r.qty : '';
  const title = `${r.name||''}${qty}`;
  const pic = img(r.img, r.name, 'thumb');
  // Monster vs Item
  if (r.type === 'monster') {
    const href = r.id ? `https://linsuol13-bit.github.io/LO/monster-${r.id}.html` : '';
    const inner = `${pic}<div class='text-sm'><div class='muted'>처치 대상</div><div class='font-medium'>${title}</div></div>`;
    return boxLink(href, inner);
  }
  // Default: item
  const href = r.id ? `https://linsuol13-bit.github.io/LO/item-${r.id}.html` : '';
  const inner = `${pic}<div class='text-sm'><div class='muted'>필요 아이템</div><div class='font-medium'>${title}</div></div>`;
  return boxLink(href, inner);
};
  const craftBox=r=>{
    const title=`${r.name} ×${r.qty||''}`;
    const pic=img(r.img,r.name,'thumb');
    const href = r.id ? `https://linsuol13-bit.github.io/LO/item-${r.id}.html` : '';
    const inner = `${pic}<div class='text-sm'><div class='muted'>제작 재료</div><div class='font-medium'>${title}</div></div>`;
    return boxLink(href, inner);
  };
  const craftNpcBox=n=>{
    const pic=n.img?img(n.img,n.name,'thumb'):'';
    let href='';
    if(n.npcId){href=`https://linsuol13-bit.github.io/LO/npc-${n.npcId}.html`;}
    else if(n.mapId){href=`https://linsuol13-bit.github.io/LO/map-${n.mapId}.html`;}
    const inner = `${pic}<div class='text-sm'><div class='muted'>제작 NPC</div><div class='font-medium'>${n.name}</div><div class='muted text-xs'>${n.place||''}</div></div>`;
    return href?`<a class='ibox' href='${href}'>${inner}</a>`:`<div class='ibox'>${inner}</div>`;
  };
  const isPlayer=w=>/^(나|플레이어|주인공|Player|영웅)$/i.test((w||'').toString().trim());
  const avatarFor=who=>{
    if(who===(q.start.npc&&q.start.npc.name))return q.start.npc.img;
    if(who===(q.finish.npc&&q.finish.npc.name))return q.finish.npc.img;
    return '';
  };
  const dialogueRow=d=>{
    d=d||{};
    const left=!isPlayer(d.who);
    const av=left?avatarFor(d.who):'';
    const avatar=(left&&av)?`<img class='avatar' src='${av}' alt='${d.who||''}' onerror="if(!this.dataset.fbk){this.dataset.fbk=1;this.src=this.src.replace('thumbnail?id=','uc?export=view&id=');}else{this.style.display='none'}">`:'';
    return `<div class='flex items-start ${left?'justify-start':'justify-end'} gap-2'>${left?avatar:''}<div class='bubble ${left?'bubble-left':'bubble-right'}'><div class='bubble-name'>${d.who||''}</div><div>${d.text||''}</div></div></div>`;
  };
  const tipBox=t=>{
    if(t.kind==='note'){
      return `<div class='ibox'><div class='text-sm leading-relaxed'>${t.text||''}</div></div>`;
    }
    const pic=img(t.img,t.name,'thumb');
    const level=t.level?` (Lv.${t.level})`:'';
    const content=`${pic}<div class='text-sm'><div class='muted'>몬스터 사냥</div><div class='font-medium'>${t.name||''}${level}</div></div>`;
    const href=t.id?`https://linsuol13-bit.github.io/LO/monster-${t.id}.html`:'';
    return href?`<a class='ibox' href='${href}'>${content}</a>`:`<div class='ibox'>${content}</div>`;
  };
  const tipsSection=list=>{ if(!Array.isArray(list)||!list.length) return ''; return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>TIP</h2><div class='grid'>${list.map(tipBox).join('')}</div></section>`; };
  const prereqSection=list=>{
    if(!Array.isArray(list)||!list.length)return'';
    const boxes=list.map(p=>`<a class='ibox' href='https://linsuol13-bit.github.io/LO/quest-${p.id}.html'><div class='text-sm'><div class='muted'>선행 퀘스트</div><div class='font-medium'>[${p.id}] ${p.title}</div></div></a>`).join('');
    return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>선행 퀘스트</h2><div class='grid'>${boxes}</div></section>`;
  };
  const nextSection=list=>{
    if(!Array.isArray(list)||!list.length)return'';
    const boxes=list.map(n=>`<a class='ibox' href='https://linsuol13-bit.github.io/LO/quest-${n.id}.html'><div class='text-sm'><div class='muted'>다음 퀘스트</div><div class='font-medium'>[${n.id}] ${n.title}</div></div></a>`).join('');
    return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>다음 퀘스트</h2><div class='grid'>${boxes}</div></section>`;
  };

const relatedSection=list=>{
    if(!Array.isArray(list)||!list.length)return'';
    const boxes=list.map(n=>`<a class='ibox' href='https://linsuol13-bit.github.io/LO/quest-${n.id}.html'><div class='text-sm'><div class='muted'>연계 퀘스트</div><div class='font-medium'>[${n.id}] ${n.title}</div></div></a>`).join('');
    return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>연계 퀘스트</h2><div class='grid'>${boxes}</div></section>`;
  };
  const reqSection=list=>{
    if(!Array.isArray(list)||!list.length)return'';
    return `<div class='mt-3'><div class='muted text-xs mb-1'>요구 조건</div><div class='grid' style='grid-template-columns:1fr 1fr; gap:.75rem'>${list.map(reqBox).join('')}</div></div>`;
  };
  const craftReqSection=list=>{
    if(!Array.isArray(list)||!list.length)return'';
    return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>제작 시 필요 아이템</h2><div class='grid' style='grid-template-columns:1fr 1fr; gap:.75rem'>${list.map(craftBox).join('')}</div></section>`;
  };
  const craftNpcSection=list=>{
    if(!Array.isArray(list)||!list.length)return'';
    return `<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>제작 NPC</h2><div class='grid' style='grid-template-columns:1fr 1fr; gap:.75rem'>${list.map(craftNpcBox).join('')}</div></section>`;
  };

  const $detail=document.getElementById('detail');
  $detail.innerHTML=`
    <header class='mb-4'><h1 class='text-2xl font-bold'>정체불명의 그녀 1-2 · 정체불명 그녀의 정체</h1><p class='text-sm muted'>${q.region} · ${q.type} · Lv.${q.minLevel}</p></header>
    ${prereqSection(q.prereqs)}
    <section class='grid' style='grid-template-columns:1fr 1fr;'>
      <div class='card'><h2 class='text-sm font-semibold mb-3'>시작</h2>${row('시작 NPC', q.start.npc.img, q.start.npc.name, '시작 장소', q.start.place.img, q.start.place.name, (q.start.npc.id?`https://linsuol13-bit.github.io/LO/npc-${q.start.npc.id}.html`:''), (q.start.place.code?`https://linsuol13-bit.github.io/LO/map-${q.start.place.code}.html`:''))}</div>
      <div class='card'><h2 class='text-sm font-semibold mb-3'>완료</h2>${row('완료 NPC', q.finish.npc.img, q.finish.npc.name, '완료 장소', q.finish.place.img, q.finish.place.name, (q.finish.npc.id?`https://linsuol13-bit.github.io/LO/npc-${q.finish.npc.id}.html`:''), (q.finish.place.code?`https://linsuol13-bit.github.io/LO/map-${q.finish.place.code}.html`:''))}</div>
    </section>
    ${(q.dialogues&&q.dialogues.length)?`<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>진행 대사</h2><div class='card'>${q.dialogues.map(dialogueRow).join("")}</div></section>`:''}
    <section class='mb-6'><h2 class='text-sm font-semibold mb-2'>퀘스트 조건</h2><div class='card text-sm leading-relaxed text-gray-800 mb-3'>${q.descHtml}</div>
      ${reqSection(q.reqs)}
    ${relatedSection(q.related)}
      ${tipsSection(q.tips)}
      ${(q.completionDialogues&&q.completionDialogues.length)?`
      <div class='mt-4 pt-3 border-t'><h2 class='text-sm font-semibold mb-2'>완료 대사</h2><div class='card'>${q.completionDialogues.map(dialogueRow).join("")}</div></div>`:''}
    </section>
    ${craftReqSection(q.craftReqs)}
    ${craftNpcSection(q.craftNpcs)}
    ${(q.rewards&&q.rewards.length)?`<section class='mb-6'><h2 class='text-sm font-semibold mb-2'>완료 보상</h2><div class='grid'>${q.rewards.map(rewardBox).join('')}</div></section>`:''}
    ${nextSection(q.nexts)}
  `;
})();
</script>
<script>
(function(){
  var a=document.getElementById('back-to-quests');
  if(!a) return;
  a.addEventListener('click',function(e){
    e.preventDefault();
    try{
      var href=this.getAttribute('href')||'index.html?tab=quests';
      var u=href+(href.indexOf('?')>-1?'&':'?')+'nocache='+Date.now();
      location.replace(u);
    }catch(err){ location.href='index.html?tab=quests'; }
  });
})();
</script>
</body>
</html>